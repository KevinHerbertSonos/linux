/*
 * Copyright (c) 2022-2023, Sonos, Inc.
 *
 * SPDX-License-Identifier:     GPL-2.0
 *
 */
/dts-v1/;

#include "sm1_s905d3_ac200.dts"

/ {
	model = "Lasso";
	amlogic-dt-id = "sm1_ac200_2g";
	compatible = "amlogic, g12a";
	interrupt-parent = <&gic>;
	#address-cells = <2>;
	#size-cells = <2>;

        sonos-product-id = <0x05>;

        dolby_fw {
                compatible = "amlogic, dolby_fw";
                mem_size = <0x100000>;
                status = "disabled";
        };

        sonos-platform {
                /* Sonos platform specific values for shared driver source & binaries */
                sonos-ampctl {
                        /* Alpine has one amp fault.  It has three control lines.
                         */
                        status = "okay";
                        hw-inits-index = <1>;
                        hw-exits-index = <1>;
                        using-i2c-amp;
                        ignore-startup-faults;
                        allow-auto-recovery;

                        sonos-ampfaults {
                                num-faults = <0x01>;
                                status = "okay";

                                ampfault@0 {
                                        fault-gpio = <&gpio GPIOA_12 GPIO_ACTIVE_LOW>;
                                        fault-flags = <IRQ_TYPE_EDGE_FALLING>;
                                        fault-label = "Amp fault";
                                } ;
                        } ;
                } ;

		misc-gpio {
			pairing-button  = <&gpio GPIOX_13 GPIO_ACTIVE_LOW>;
			no-irq;
			wall-mount = <&gpio GPIOZ_15 GPIO_ACTIVE_HIGH>;
		};
		gpio-switch {
			compatible = "sonos,gpio-switch";
			micmute = <&gpio_ao GPIOAO_9 GPIO_ACTIVE_HIGH>;
		};
		simulated-buttons {
			/* event-sources are offsets from EVTSOURCE_BUTTON_PLAYPAUSE
			 * some generate an event for more than one source
			 */
			power {
				 event-sources = <5>;
				 no-repeat-sim;
			};
			pairing {
				 event-sources = <7>;
				 no-repeat-sim;
			};
		};
                thermal-mgmt {
                        CPU {
                                compatible = "tmp102";
                                fault-temperature = <95>;
                                warn-temperature = <91>;
                        };
                        SOC {
                                compatible = "amlogic, s767_temp";
                                fault-temperature = <105>;
                                warn-temperature = <105>;
                        };
		};
		psoc_gpios: gpiochip4 {
			compatible = "sonos,psoc-gpio";
			gpio-controller;
			num-gpios = <1>;
			#gpio-cells = <2>;
			status = "okay";
		};
		micctl_gpio:sonos-gpio-micctl {
			compatible = "sonos,gpio-mics";
			micctl-gpio = <&psoc_gpios 0 GPIO_ACTIVE_HIGH>;
		};
		micctl@1 {
			compatible = "sonos,micctl";
			micctl-device = <&micctl_gpio>;
		};
	} ;

	meson-ir {
		status = "okay";
		protocol = <REMOTE_TYPE_RAW_NEC>;
		pinctrl-names = "default";
	};

	ir-rcvr {
		compatible = "sonos,ir-rcvr";
		status = "okay";
	};
	thermal-zones {
                cputhermal: cputhermal {
                        polling-delay-passive = <1000>;
                        polling-delay = <1000>;
                        /* sensor ID */
                        thermal-sensors = <&cputempsensor 0>;
		};
	};

	aliases {
		serial0 = &uart_AO;
		serial1 = &uart_A;
		serial2 = &uart_B;
		serial3 = &uart_C;
		serial4 = &uart_AO_B;
		tsensor0 = &p_tsensor;
		tsensor1 = &d_tsensor;
		i2c0 = &i2c0;
		i2c1 = &i2c1;
		i2c2 = &i2c2;
		i2c3 = &i2c3;
		i2c4 = &i2c_AO;
		spicc0 = &spicc0;
		spicc1 = &spicc1;
	};

	memory@00000000 {
		device_type = "memory";
		linux,usable-memory = <0x0 0x000000 0x0 0x80000000>;
	};

	reserved-memory {
		#address-cells = <2>;
		#size-cells = <2>;
		ranges;
		/* global autoconfigured region for contiguous allocations */
		ramoops@0x07400000 {
			compatible = "ramoops";
			reg = <0x0 0x07400000 0x0 0x00100000>;
			record-size = <0x8000>;
			console-size = <0x10000>;
			ftrace-size = <0x2000>;
			pmsg-size = <0x4000>;
		};
		secmon_reserved:linux,secmon {
			compatible = "shared-dma-pool";
			reusable;
			size = <0x0 0x400000>;
			alignment = <0x0 0x400000>;
			alloc-ranges = <0x0 0x05000000 0x0 0x400000>;
		};
		secos_reserved:linux,secos {
			status = "disabled";
			compatible = "amlogic, aml_secos_memory";
			reg = <0x0 0x05300000 0x0 0x2000000>;
			no-map;
		};
		logo_reserved:linux,meson-fb {
			compatible = "shared-dma-pool";
			reusable;
			size = <0x0 0x800000>;
			alignment = <0x0 0x400000>;
			alloc-ranges = <0x0 0x7f800000 0x0 0x800000>;
		};
		ion_cma_reserved:linux,ion-dev {
			compatible = "shared-dma-pool";
			reusable;
			size = <0x0 0x8000000>;
			alignment = <0x0 0x400000>;
		};
		/*di CMA pool */
		di_cma_reserved:linux,di_cma {
			compatible = "shared-dma-pool";
			reusable;
			/* buffer_size = 3621952(yuv422 8bit)
			 *  | 4736064(yuv422 10bit)
			 *  | 4074560(yuv422 10bit full pack mode)
			 * 10x3621952=34.6M(0x23) support 8bit
			 * 10x4736064=45.2M(0x2e) support 12bit
			 * 10x4074560=40M(0x28) support 10bit
			 */
			size = <0x0 0x02800000>;
			alignment = <0x0 0x400000>;
		};
		/*  POST PROCESS MANAGER */
		ppmgr_reserved:linux,ppmgr {
			compatible = "shared-dma-pool";
			size = <0x0 0x0>;
		};

		codec_mm_cma:linux,codec_mm_cma {
			compatible = "shared-dma-pool";
			reusable;
			/* ion_codec_mm max can alloc size 80M*/
			size = <0x0 0x13400000>;
			alignment = <0x0 0x400000>;
			linux,contiguous-region;
		};
		/* codec shared reserved */
		codec_mm_reserved:linux,codec_mm_reserved {
			compatible = "amlogic, codec-mm-reserved";
			size = <0x0 0x0>;
			alignment = <0x0 0x100000>;
			//no-map;
		};
		/*  vdin1 CMA pool */
		vdin1_cma_reserved:linux,vdin1_cma {
			compatible = "shared-dma-pool";
			reusable;
			/* up to 1920x1080 yuv422 8bit and 5 buffers
			 * 1920x1080x2x5 = 20 M
			 */
			size = <0x0 0x01400000>;
			alignment = <0x0 0x400000>;
		};
		vm0_cma_reserved:linux,vm0_cma {
			compatible = "shared-dma-pool";
			reusable;
			size = <0x0 0x2000000>;
			alignment = <0x0 0x400000>;
		};
	};

	galcore {
		status = "okay";
	};
	gpioleds {
		compatible = "gpio-leds";
		status = "okay";

		sys_led {
			label="sys_led";
			gpios=<&gpio_ao GPIOAO_11 GPIO_ACTIVE_HIGH>;
			default-state ="on";
		};
	};

	cvbsout {
		compatible = "amlogic, cvbsout-sm1";
		dev_name = "cvbsout";
		status = "okay";
		clocks = <&clkc CLKID_VCLK2_ENCI
			&clkc CLKID_VCLK2_VENCI0
			&clkc CLKID_VCLK2_VENCI1
			&clkc CLKID_DAC_CLK>;
		clock-names = "venci_top_gate",
			"venci_0_gate",
			"venci_1_gate",
			"vdac_clk_gate";
		/* clk path */
		/* 0:vid_pll vid2_clk */
		/* 1:gp0_pll vid2_clk */
		/* 2:vid_pll vid1_clk */
		/* 3:gp0_pll vid1_clk */
		clk_path = <0>;

		/* performance: reg_address, reg_value */
		/* sm1 */
		performance = <0x1bf0  0x9
			0x1b56  0x333
			0x1b12  0x8080
			0x1b05  0xfd
			0x1c59  0xf850
			0xffff  0x0>; /* ending flag */
		performance_sarft = <0x1bf0  0x9
			0x1b56  0x333
			0x1b12  0x0
			0x1b05  0x9
			0x1c59  0xfc48
			0xffff  0x0>; /* ending flag */
		performance_revB_telecom = <0x1bf0  0x9
			0x1b56  0x546
			0x1b12  0x8080
			0x1b05  0x9
			0x1c59  0xf850
			0xffff  0x0>; /* ending flag */
	};

	bt-dev{
		compatible = "amlogic, bt-dev";
		dev_name = "bt-dev";
		status = "okay";
		gpio_reset = <&gpio       GPIOX_17       GPIO_ACTIVE_HIGH>;
		gpio_hostwake = <&gpio       GPIOX_19       GPIO_ACTIVE_HIGH>;
	};

	wifi{
		compatible = "amlogic, aml_wifi";
		dev_name = "aml_wifi";
		status = "okay";
		interrupt_pin = <&gpio       GPIOX_6       GPIO_ACTIVE_HIGH>;
		irq_trigger_type = "GPIO_IRQ_LOW";
		power_on_pin = <&gpio       GPIOX_7       GPIO_ACTIVE_HIGH>;
		dhd_static_buf;	//if use bcm wifi, config dhd_static_buf
		pinctrl-names = "default";
		pinctrl-0 = <&pwm_e_pins>;
		pwm_config = <&wifi_pwm_conf>;
	};

	wifi_pwm_conf:wifi_pwm_conf{
		pwm_channel1_conf {
			pwms = <&pwm_ef MESON_PWM_0 30541 0>;
			duty-cycle = <15270>;
			times = <10>;
		};
		pwm_channel2_conf {
			pwms = <&pwm_ef MESON_PWM_2 30500 0>;
			duty-cycle = <15250>;
			times = <12>;
		};
	};

	codec_mm {
		compatible = "amlogic, codec, mm";
		memory-region = <&codec_mm_cma &codec_mm_reserved>;
		dev_name = "codec_mm";
		status = "okay";
	};

	picdec_cma_reserved:linux,picdec {
		compatible = "shared-dma-pool";
		reusable;
		size = <0x0>;
		alignment = <0x0>;
		linux,contiguous-region;
	};

	picdec {
		compatible = "amlogic, picdec";
		memory-region = <&picdec_cma_reserved>;
		dev_name = "picdec";
		status = "okay";
	};

	ppmgr {
		compatible = "amlogic, ppmgr";
		memory-region = <&ppmgr_reserved>;
		dev_name = "ppmgr";
		status = "okay";
	};

	deinterlace {
		compatible = "amlogic, deinterlace";
		status = "disabled";
		/* 0:use reserved; 1:use cma; 2:use cma as reserved */
		flag_cma = <1>;
		//memory-region = <&di_reserved>;
		memory-region = <&di_cma_reserved>;
		interrupts = <0 46 1
				0 40 1>;
		interrupt-names = "pre_irq", "post_irq";
		clocks = <&clkc CLKID_VPU_CLKB_TMP_DIV>,
			<&clkc CLKID_VPU_CLKB_TMP>;
		clock-names = "vpu_clkb_tmp_composite",
			"vpu_clkb_composite";
		clock-range = <334 667>;
		/* buffer-size = <3621952>;(yuv422 8bit) */
		buffer-size = <4074560>;/*yuv422 fullpack*/
		/* reserve-iomap = "true"; */
		/* if enable nr10bit, set nr10bit-support to 1 */
		post-wr-support = <1>;
		nr10bit-support = <1>;
		nrds-enable = <1>;
		pps-enable = <1>;
	};
	ionvideo {
		compatible = "amlogic, ionvideo";
		dev_name = "ionvideo";
		status = "okay";
	};
	partitions: partitions{
		parts = <14>;
		part-0 = <&logo>;
		part-1 = <&recovery>;
		part-2 = <&misc>;
		part-3 = <&dto>;
		part-4 = <&cri_data>;
		part-5 = <&param>;
		part-6 = <&boot>;
		part-7 = <&rsv>;
		part-8 = <&tee>;
		part-9 = <&vendor>;
		part-10 = <&odm>;
		part-11 = <&system>;
		part-12 = <&cache>;
		part-13 = <&data>;

		logo:logo{
			pname = "logo";
			size = <0x0 0x800000>;
			mask = <1>;
		};
		recovery:recovery{
			pname = "recovery";
			size = <0x0 0x1800000>;
			mask = <1>;
		};
		misc:misc{
			pname = "misc";
			size = <0x0 0x800000>;
			mask = <1>;
		};
		dto:dto{
			pname = "dto";
			size = <0x0 0x800000>;
			mask = <1>;
		};
		cri_data:cri_data{
			pname = "cri_data";
			size = <0x0 0x800000>;
			mask = <2>;
		};
		rsv:rsv{
			pname = "rsv";
			size = <0x0 0x1000000>;
			mask = <1>;
		};
		param:param{
			pname = "param";
			size = <0x0 0x1000000>;
			mask = <2>;
		};
		boot:boot{
			pname = "boot";
			size = <0x0 0x1000000>;
			mask = <1>;
		};
		tee:tee{
			pname = "tee";
			size = <0x0 0x2000000>;
			mask = <1>;
		};
		vendor:vendor{
			pname = "vendor";
			size = <0x0 0x10000000>;
			mask = <1>;
		};
		odm:odm{
			pname = "odm";
			size = <0x0 0x10000000>;
			mask = <1>;
		};
		system:system{
			pname = "system";
			size = <0x0 0x80000000>;
			mask = <1>;
		};
		cache:cache{
			pname = "cache";
			size = <0x0 0x46000000>;
			mask = <2>;
		};
		data:data{
			pname = "data";
			size = <0xffffffff 0xffffffff>;
			mask = <4>;
		};
	};
	vm0 {
		compatible = "amlogic, vm";
		memory-region = <&vm0_cma_reserved>;
		dev_name = "vm0";
		status = "disabled";
		vm_id = <0>;
	};

        amvdec_656in {
                /*bt656 gpio conflict with i2c0*/
                compatible = "amlogic, bt656in-sm1";
                status = "disabled";
                reg = <0x0 0xffe02000 0x0 0x7c>;
                clocks = <&clkc CLKID_BT656_GATE>,
                        <&clkc CLKID_BT656>;
                clock-names = "cts_bt656_clk1",
                        "clk_gate_bt656";
                /* bt656in1, bt656in2 */
                bt656in1 {
                bt656_id = <1>;
                status = "disabled";
                };
	};

	amlvecm {
		compatible = "amlogic, vecm";
		dev_name = "aml_vecm";
		status = "okay";
		gamma_en = <0>;/*1:enabel ;0:disable*/
		wb_en = <0>;/*1:enabel ;0:disable*/
		cm_en = <0>;/*1:enabel ;0:disable*/
		/*0: 709/601  1: bt2020*/
		tx_op_color_primary = <0>;
	};

	amdolby_vision {
		compatible = "amlogic, dolby_vision_sm1";
		dev_name = "aml_amdolby_vision_driver";
		status = "okay";
		tv_mode = <0>;/*1:enabel ;0:disable*/
	};

	/* --------------- Audio Related start --------------- */
	tdm_codec:dummy {
		#sound-dai-cells = <0>;
		compatible = "amlogic,aml_dummy_codec";
		stream-name = "0-dac";
		rate = <44100>;    /* We use 44.1 KHz as the audio output rate */
		format = "S32_LE"; /* We use signed 24-bit little endian samples in a 32-bit word */
		channels = <24>;    /* Number of playback channels on Lasso is 15 (3 lanes of 3 amps x 2 ch each)
							  plus 2 unused channels on each lane. */
		status = "okay";
	};
	pdm_codec:dummy {
		#sound-dai-cells = <0>;
		compatible = "amlogic,pdm_dummy_codec";
		stream-name = "1-mic";
		rate = <48000>;    /* We use 48 KHz as the audio input rate. */
		format = "S32_LE"; /* We use signed 24-bit little endian samples in 32-bit words */
		channels = <6>;    /* Number of capture channels on Lasso is 6 */
		capture;           /* Set the stream direction to capture. Note: Default without this boolean flag 
							  is playback */
		status = "okay";
	};
	earc_codec:dummy{
		#sound-dai-cells = <0>;
		compatible = "amlogic, aml_dummy_codec";
		capture;
		status = "okay";
	};

	audiolocker: locker {
		compatible = "amlogic, audiolocker";
		clocks = <&clkaudio CLKID_AUDIO_LOCKER_OUT
				&clkaudio CLKID_AUDIO_LOCKER_IN
				&clkaudio CLKID_AUDIO_MCLK_D
				&clkaudio CLKID_AUDIO_MCLK_E
				&clkc CLKID_MPLL1
				&clkc CLKID_MPLL2>;
		clock-names = "lock_out", "lock_in", "out_src",
					"in_src", "out_calc", "in_ref";
		interrupts = <GIC_SPI 1 IRQ_TYPE_EDGE_RISING>;
		interrupt-names = "irq";
		frequency = <49000000>; /* pll */
		dividor = <49>; /* locker's parent */
		status = "disabled";
	};

	tuner: tuner {
		compatible = "amlogic, tuner";
		status = "okay";
		tuner_name = "mxl661_tuner";
		tuner_i2c_adap = <&i2c1>;
		tuner_i2c_addr = <0x60>;
		tuner_xtal = <0>; /* 0: 16MHz, 1: 24MHz */
		tuner_xtal_mode = <0>;
					/* NO_SHARE_XTAL(0)
					 * SLAVE_XTAL_SHARE(1)
					 */
		tuner_xtal_cap = <30>; /* when tuner_xtal_mode = 1, set 25 */
	};


	sonos_rollback:sonos-rollback@ff800000 {
		compatible = "sonos,sonos-rollback";
		reg = <0x0 0xff800000 0x0 0x4>;
		offset = <0x00>;
		shift = <0>;
	};

	efuse: efuse {
		compatible = "amlogic, efuse";
		read_cmd = <0x82000030>;
		write_cmd = <0x82000031>;
		get_max_cmd = <0x82000033>;
		read_obj_cmd = <0x82000038>;
		write_obj_cmd = <0x82000039>;
		mem_in_base_cmd = <0x82000020>;
		mem_out_base_cmd = <0x82000021>;
		key = <&efusekey>;
		clocks = <&clkc CLKID_EFUSE>;
		clock-names = "efuse_clk";
		status = "okay";
	};

	cpu_iomap {
		compatible = "amlogic, iomap";
		#address-cells=<2>;
		#size-cells=<2>;
		ranges;
		io_cbus_base {
			reg = <0x0 0xffd00000 0x0 0x26fff>;
		};
		io_apb_base {
			reg = <0x0 0xffe01000 0x0 0x7f000>;
		};
		io_aobus_base {
			reg = <0x0 0xff800000 0x0 0xb000>;
		};
		io_vapb_base {
			reg = <0x0 0xff900000 0x0 0x50000>;
		};
		io_hiu_base {
			reg = <0x0 0xff63c000 0x0 0x2000>;
		};
	};
	auge_sound {
		/delete-property/ avout_mute-gpios;
		aml-audio-card,dai-link@1 {
			tdmbcodec: codec {
				sound-dai = <&dummy_codec &amlogic_codec>;
			};
		};
	};
};

&pwm_AO_cd {
		status = "okay";
};

&i2c0 {
	status = "okay";
	pinctrl-names="default";
	pinctrl-0=<&i2c0_sda_c_pins>;
	clock-frequency = <100000>;

	/* Richtek AMPS
	 * rt9120s
	 * Nine amps, amp4 & amp5 use PBTL mode and the rest use BTL mode
	 */
	amp1: rt9120s@18 {
		compatible = "richtek,rt9120s";
		reg = <0x18>;
		dev-id = <0x1>;
		first-amp-devid = <7>;
		shared-reset;
		mask-faults;
		reset-gpio = <&gpio GPIOA_13 GPIO_ACTIVE_LOW>;
		post-reset-delay = <10>;
		stage-delay = <20>;
		post-pause-delay = <100>;
		number-init-stages = <2>;
		init-sequence-length1 = <1>;
		reg-init1 = <0x40 0x80>;
		init-sequence-length2 = <15>;
		reg-init2 = < 0x63 0xDE 0x6C 0xC0 0x07 0x36 0x65 0x66 0x06 0x28
			0x02 0x03 0xA0 0x01 0xA1 0x08 0xA2 0x0C 0x27 0x01B0
			0x20 0x0180 0x0C 0x38 0x09 0x81 0x6E 0x1D 0x10 0x00>;
		play-a1-a2 = <0x00 0x04>;
		status = "okay";
	};

	amp2: rt9120s@19 {
		compatible = "richtek,rt9120s";
		reg = <0x19>;
		dev-id = <0x2>;
		first-amp-devid = <7>;
		shared-reset;
		reset-gpio = <&gpio GPIOA_13 GPIO_ACTIVE_LOW>;
		post-reset-delay = <10>;
		stage-delay = <20>;
		post-pause-delay = <100>;
		number-init-stages = <2>;
		init-sequence-length1 = <1>;
		reg-init1 = <0x40 0x80>;
		init-sequence-length2 = <15>;
		reg-init2 = < 0x63 0xDE 0x6C 0xC0 0x07 0x36 0x65 0x66 0x06 0x28
			0x02 0x03 0xA0 0x01 0xA1 0x08 0xA2 0x0C 0x27 0x01B0
			0x20 0x0180 0x0C 0x38 0x09 0x81 0x6E 0x1D 0x10 0x00>;
		play-a1-a2 = <0x08 0x0C>;
		status = "okay";
	};

	amp3: rt9120s@1a {
		compatible = "richtek,rt9120s";
		reg = <0x1a>;
		dev-id = <0x3>;
		first-amp-devid = <7>;
		shared-reset;
		reset-gpio = <&gpio GPIOA_13 GPIO_ACTIVE_LOW>;
		post-reset-delay = <10>;
		stage-delay = <20>;
		post-pause-delay = <100>;
		number-init-stages = <2>;
		init-sequence-length1 = <1>;
		reg-init1 = <0x40 0x80>;
		init-sequence-length2 = <15>;
		reg-init2 = < 0x63 0xDE 0x6C 0xC0 0x07 0x36 0x65 0x66 0x06 0x28
			0x02 0x03 0xA0 0x01 0xA1 0x08 0xA2 0x0C 0x27 0x01B0
			0x20 0x0180 0x0C 0x38 0x09 0x81 0x6E 0x1D 0x10 0x00>;
		play-a1-a2 = <0x10 0x14>;
		status = "okay";
	};
};

&i2c1 {
	status = "okay";
	pinctrl-names="default";
	pinctrl-0=<&i2c1_sda_x_pins>;
	clock-frequency = <100000>;

	amp4: rt9120s@1b {
		compatible = "richtek,rt9120s";
		reg = <0x1b>;
		dev-id = <0x4>;
		first-amp-devid = <7>;
		shared-reset;
		parallel-play;
		reset-gpio = <&gpio GPIOA_13 GPIO_ACTIVE_LOW>;
		post-reset-delay = <10>;
		stage-delay = <20>;
		post-pause-delay = <100>;
		number-init-stages = <2>;
		init-sequence-length1 = <1>;
		reg-init1 = <0x40 0x80>;
		init-sequence-length2 = <17>;
		reg-init2 = < 0x63 0xDE 0x6C 0xC0 0x07 0x36 0x65 0x77 0x06 0x28
			0x02 0x03 0xA0 0x01 0xA1 0x08 0xA2 0x0C 0x15 0x40
			0x64 0x59 0x27 0x01B0 0x20 0x0180 0x0C 0x38 0x09 0x81
			0x6E 0x1D 0x10 0x00>;
		play-a1-a2 = <0x00 0x04>;
		status = "okay";
	};

	amp5: rt9120s@18 {
		compatible = "richtek,rt9120s";
		reg = <0x18>;
		dev-id = <0x5>;
		first-amp-devid = <7>;
		shared-reset;
		parallel-play;
		reset-gpio = <&gpio GPIOA_13 GPIO_ACTIVE_LOW>;
		post-reset-delay = <10>;
		stage-delay = <20>;
		post-pause-delay = <100>;
		number-init-stages = <2>;
		init-sequence-length1 = <1>;
		reg-init1 = <0x40 0x80>;
		init-sequence-length2 = <17>;
		reg-init2 = < 0x63 0xDE 0x6C 0xC0 0x07 0x36 0x65 0x77 0x06 0x28
			0x02 0x03 0xA0 0x01 0xA1 0x08 0xA2 0x0C 0x15 0x40
			0x64 0x59 0x27 0x01B0 0x20 0x0180 0x0C 0x38 0x09 0x81
			0x6E 0x1D 0x10 0x00>;
		play-a1-a2 = <0x00 0x04>;
		status = "okay";
	};

	amp6: rt9120s@19 {
		compatible = "richtek,rt9120s";
		reg = <0x19>;
		dev-id = <0x6>;
		first-amp-devid = <7>;
		shared-reset;
		reset-gpio = <&gpio GPIOA_13 GPIO_ACTIVE_LOW>;
		post-reset-delay = <10>;
		stage-delay = <20>;
		post-pause-delay = <100>;
		number-init-stages = <2>;
		init-sequence-length1 = <1>;
		reg-init1 = <0x40 0x80>;
		init-sequence-length2 = <15>;
		reg-init2 = < 0x63 0xDE 0x6C 0xC0 0x07 0x36 0x65 0x66 0x06 0x28
			0x02 0x03 0xA0 0x01 0xA1 0x08 0xA2 0x0C 0x27 0x01B0
			0x20 0x0180 0x0C 0x38 0x09 0x81 0x6E 0x1D 0x10 0x00>;
		play-a1-a2 = <0x08 0x0C>;
		status = "okay";
	};
};

&i2c2 {
	status = "okay";
	pinctrl-names="default";
	pinctrl-0=<&i2c2_sda_x_pins>;
	clock-frequency = <100000>;

	apple_auth@0 {
		compatible = "Sonos,apple_auth";
		reg = <0x10>;
	};

	cputempsensor: tmp102@48 {
                compatible = "tmp102";
                reg = <0x48>;
                device_type="CPU";
                #thermal-sensor-cells = <1>;
        };

	rtc: mcp7940x@6f {
		compatible = "mcp7940x";
		reg = <0x6f>;
		interrupt-parent = <&gpio_intc>;
		interrupts = <GPIOAO_4 IRQ_TYPE_EDGE_FALLING>;
	};
};

&i2c3 {

	/delete-property/ pinctrl-0;
	/delete-node/ ad82584f1;
	amp7: rt9120s@1a {
		compatible = "richtek,rt9120s";
		reg = <0x1a>;
		dev-id = <0x7>;
		first-amp-devid = <7>;
		shared-reset;
		reset-gpio = <&gpio GPIOA_13 GPIO_ACTIVE_LOW>;
		post-reset-delay = <10>;
		stage-delay = <20>;
		post-pause-delay = <100>;
		number-init-stages = <2>;
		init-sequence-length1 = <1>;
		reg-init1 = <0x40 0x80>;
		init-sequence-length2 = <15>;
		reg-init2 = < 0x63 0xDE 0x6C 0xC0 0x07 0x36 0x65 0x66 0x06 0x28
			0x02 0x03 0xA0 0x01 0xA1 0x08 0xA2 0x0C 0x27 0x01B0
			0x20 0x0180 0x0C 0x38 0x09 0x81 0x6E 0x1D 0x10 0x00>;
		play-a1-a2 = <0x00 0x04>;
		status = "okay";
	};

	amp8: rt9120s@1b {
		compatible = "richtek,rt9120s";
		reg = <0x1b>;
		dev-id = <0x8>;
		first-amp-devid = <7>;
		shared-reset;
		reset-gpio = <&gpio GPIOA_13 GPIO_ACTIVE_LOW>;
		post-reset-delay = <10>;
		stage-delay = <20>;
		post-pause-delay = <100>;
		number-init-stages = <2>;
		init-sequence-length1 = <1>;
		reg-init1 = <0x40 0x80>;
		init-sequence-length2 = <15>;
		reg-init2 = < 0x63 0xDE 0x6C 0xC0 0x07 0x36 0x65 0x66 0x06 0x28
			0x02 0x03 0xA0 0x01 0xA1 0x08 0xA2 0x0C 0x27 0x01B0
			0x20 0x0180 0x0C 0x38 0x09 0x81 0x6E 0x1D 0x10 0x00>;
		play-a1-a2 = <0x08 0x0C>;
		status = "okay";
	};

	amp9: rt9120s@18 {
		compatible = "richtek,rt9120s";
		reg = <0x18>;
		dev-id = <0x9>;
		first-amp-devid = <7>;
		shared-reset;
		reset-gpio = <&gpio GPIOA_13 GPIO_ACTIVE_LOW>;
		post-reset-delay = <10>;
		stage-delay = <20>;
		post-pause-delay = <100>;
		number-init-stages = <2>;
		init-sequence-length1 = <1>;
		reg-init1 = <0x40 0x80>;
		init-sequence-length2 = <15>;
		reg-init2 = < 0x63 0xDE 0x6C 0xC0 0x07 0x36 0x65 0x66 0x06 0x28
			0x02 0x03 0xA0 0x01 0xA1 0x08 0xA2 0x0C 0x27 0x01B0
			0x20 0x0180 0x0C 0x38 0x09 0x81 0x6E 0x1D 0x10 0x00>;
		play-a1-a2 = <0x10 0x14>;
		status = "okay";
	};
};

&i2c_AO {
	status = "okay";
	pinctrl-names="default";
	pinctrl-0=<&i2c_ao_sck_pins>;
	clock-frequency = <100000>;

	is31fl3195@54 {  // LED controller
           compatible = "lumissil,is31fl3195";
           status = "okay";
           reg = <0x54>;
	};

	bma420@0 {  // accelerometer
           compatible = "sonos,bma420";
           status = "okay";
           reg = <0x18>;
           motion-detection-mode;
           music-impacts-z-axis;
           reinit-on-resume;
	};

	sge@0 {  // Sigdetail Gesture Engine
		compatible = "Sonos,sge-psoc4";
		pinctrl-names = "mode-uart-hiz", "mode-flow-ctrl";
		pinctrl-0 = <>;
		pinctrl-1 = <>;
		reg = <0x40>;
		gpio-addr = <0xff800000 0x130 0x34 0x0 0x28 0x34 0x0 0x28>;
		gpio-params = "base-addr", "len", "io-set", "io-clr", "io-din", "scl-set", "scl-clr", "scl-din";
		scl-bitmask =  <0x000010>;
		io-bitmask  =  <0x000040>;
		xres-gpio = <&gpio_ao GPIOAO_7 GPIO_ACTIVE_HIGH>;
		io-gpio   = <&gpio_ao GPIOAO_6 GPIO_ACTIVE_HIGH>;
		scl-gpio  = <&gpio_ao GPIOAO_4 GPIO_ACTIVE_HIGH>;
		irq-gpio  = <&gpio_ao GPIOAO_8 GPIO_ACTIVE_HIGH>;
		share-swd-uart = <0>;
		psoc-rtc = <0>;
		leanui-layout-proto;
		psoc-flash-verify-disabled;
		status = "okay";


		psoc-images {
			image@0 {
				model-num = <4025>;
				ident = <0x1a>;
				flash-rows = <256>;
				flash-row-size = <128>;
				flash-protection-size = <32>;
			};
		};

	};
};

&spicc0 {
	status = "disabled";
};

&spicc1 {
	status = "disabled";
};

&audiobus {
	tdma:tdm@0 {
		pinctrl-names = "tdm_pins";
		pinctrl-0 = <&tdm_a_dout0_pins
			     &tdm_a_sclk_pins
			     &tdm_a_fs_pins
			     &tdm_a_slv_sclk_pins>;
	};

	tdmlb:tdm@3 {
		compatible = "amlogic, sm1-snd-tdmlb";
		#sound-dai-cells = <0>;

		dai-tdm-lane-lb-slot-mask-in = <1 0 0 0>;
		dai-tdm-clk-sel = <1>;

		clocks = <&clkaudio CLKID_AUDIO_MCLK_B
				&clkc CLKID_MPLL1>;
		clock-names = "mclk", "clk_srcpll";

		/*
		 * select tdmin_lb src;
		 * AXG
		 *  0: TDMOUTA
		 *  1: TDMOUTB
		 *  2: TDMOUTC
		 *  3: PAD_TDMINA
		 *  4: PAD_TDMINB
		 *  5: PAD_TDMINC
		 *
		 * G12A/G12B
		 *  0: TDMOUTA
		 *  1: TDMOUTB
		 *  2: TDMOUTC
		 *  3: PAD_TDMINA_DIN*
		 *  4: PAD_TDMINB_DIN*
		 *  5: PAD_TDMINC_DIN*
		 *  6: PAD_TDMINA_D*, oe pin
		 *  7: PAD_TDMINB_D*, oe pin
		 *
		 * TL1/SM1
		 *  0: TDMOUTA
		 *  1: TDMOUTB
		 *  2: TDMOUTC
		 *  3: PAD_TDMINA_DIN*
		 *  4: PAD_TDMINB_DIN*
		 *  5: PAD_TDMINC_DIN*
		 *  6: PAD_TDMINA_D*
		 *  7: PAD_TDMINB_D*
		 *  8: PAD_TDMINC_D*
		 *  9: HDMIRX_I2S
		 *  10: ACODEC_ADC
		 */
		lb-src-sel = <1>;

		status = "disabled";
	};

	asrca: resample@0 {
		compatible = "amlogic, sm1-resample";
		clocks = <&clkc CLKID_MPLL3
				&clkaudio CLKID_AUDIO_MCLK_F
				&clkaudio CLKID_AUDIO_RESAMPLE_A>;
		clock-names = "resample_pll", "resample_src", "resample_clk";
		/*same with toddr_src
		 *	TDMIN_A, 0
		 *	TDMIN_B, 1
		 *	TDMIN_C, 2
		 *	SPDIFIN, 3
		 *	PDMIN,  4
		 *	NONE,
		 *	TDMIN_LB, 6
		 *	LOOPBACK, 7
		 */
		resample_module = <4>;
		status = "disabled";
	};

	vad:vad {
		compatible = "amlogic, snd-vad";
		#sound-dai-cells = <0>;

		clocks = <&clkaudio CLKID_AUDIO_GATE_TOVAD
			&clkc CLKID_FCLK_DIV5
			&clkaudio CLKID_AUDIO_VAD>;
		clock-names = "gate", "pll", "clk";

		interrupts = <GIC_SPI 155 IRQ_TYPE_EDGE_RISING
				GIC_SPI 48 IRQ_TYPE_EDGE_RISING>;
		interrupt-names = "irq_wakeup", "irq_frame_sync";

		/*
		 * Data src sel:
		 * 0: tdmin_a;
		 * 1: tdmin_b;
		 * 2: tdmin_c;
		 * 3: spdifin;
		 * 4: pdmin;
		 * 5: loopback_b;
		 * 6: tdmin_lb;
		 * 7: loopback_a;
		 */
		src = <4>;

		/*
		 * deal with hot word in user space or kernel space
		 * 0: in user space
		 * 1: in kernel space
		 */
		level = <1>;

		status = "okay";
	};

	loopbacka:loopback@0 {
		compatible = "amlogic, sm1-loopbacka";
		#sound-dai-cells = <0>;

		clocks = <&clkaudio CLKID_AUDIO_GATE_PDM
			&clkc CLKID_FCLK_DIV3
			&clkc CLKID_MPLL3
			&clkaudio CLKID_AUDIO_PDMIN0
			&clkaudio CLKID_AUDIO_PDMIN1
			&clkc CLKID_MPLL0
			&clkaudio CLKID_AUDIO_MCLK_A>;
		clock-names = "pdm_gate",
			"pdm_sysclk_srcpll",
			"pdm_dclk_srcpll",
			"pdm_dclk",
			"pdm_sysclk",
			"tdminlb_mpll",
			"tdminlb_mclk";

		/* datain src
		 * 0: tdmin_a;
		 * 1: tdmin_b;
		 * 2: tdmin_c;
		 * 3: spdifin;
		 * 4: pdmin;
		 */
		datain_src = <4>;
		datain_chnum = <6>;
		datain_chmask = <0x3f>;
		/* config which data pin for loopback */
		datain-lane-mask-in = <1 1 1 0>;

		/* calc mclk for datalb */
		mclk-fs = <256>;

		/* tdmin_lb src
		 * 0: tdmoutA
		 * 1: tdmoutB
		 * 2: tdmoutC
		 * 3: PAD_TDMINA_DIN*, refer to core pinmux
		 * 4: PAD_TDMINB_DIN*, refer to core pinmux
		 * 5: PAD_TDMINC_DIN*, refer to core pinmux
		 * 6: PAD_TDMINA_D*, oe, refer to core pinmux
		 * 7: PAD_TDMINB_D*, oe, refer to core pinmux
		 */
		/* if tdmin_lb >= 3, use external loopback */
		datalb_src = <1>;
		datalb_chnum = <2>;
		datalb_chmask = <0x3>;
		/* config which data pin as loopback */
		datalb-lane-mask-in = <1 0 0 0>;

		status = "okay";
	};

	loopbackb:loopback@1 {
		compatible = "amlogic, sm1-loopbackb";
		#sound-dai-cells = <0>;

		clocks = <&clkaudio CLKID_AUDIO_GATE_PDM
			&clkc CLKID_FCLK_DIV3
			&clkc CLKID_MPLL3
			&clkaudio CLKID_AUDIO_PDMIN0
			&clkaudio CLKID_AUDIO_PDMIN1
			&clkc CLKID_MPLL0
			&clkaudio CLKID_AUDIO_MCLK_A>;
		clock-names = "pdm_gate",
			"pdm_sysclk_srcpll",
			"pdm_dclk_srcpll",
			"pdm_dclk",
			"pdm_sysclk",
			"tdminlb_mpll",
			"tdminlb_mclk";

		/* calc mclk for datain_lb */
		mclk-fs = <256>;

		/* datain src
		 * 0: tdmin_a;
		 * 1: tdmin_b;
		 * 2: tdmin_c;
		 * 3: spdifin;
		 * 4: pdmin;
		 */
		datain_src = <4>;
		datain_chnum = <4>;
		datain_chmask = <0xf>;
		/* config which data pin for loopback */
		datain-lane-mask-in = <1 0 1 0>;

		/* tdmin_lb src
		 * 0: tdmoutA
		 * 1: tdmoutB
		 * 2: tdmoutC
		 * 3: PAD_TDMINA_DIN*, refer to core pinmux
		 * 4: PAD_TDMINB_DIN*, refer to core pinmux
		 * 5: PAD_TDMINC_DIN*, refer to core pinmux
		 * 6: PAD_TDMINA_D*, oe, refer to core pinmux
		 * 7: PAD_TDMINB_D*, oe, refer to core pinmux
		 */
		/* if tdmin_lb >= 3, use external loopback */
		datalb_src = <1>;
		datalb_chnum = <2>;
		datalb_chmask = <0x3>;
		/* config which data pin as loopback */
		datalb-lane-mask-in = <1 0 0 0>;

		status = "disabled";
	};
	aed:effect {
		compatible = "amlogic, snd-effect-v3";
		#sound-dai-cells = <0>;
		clocks = <&clkaudio CLKID_AUDIO_GATE_EQDRC
			&clkc CLKID_FCLK_DIV5
			&clkaudio CLKID_AUDIO_EQDRC>;
		clock-names = "gate", "srcpll", "eqdrc";
		/*
		 * 0:tdmout_a
		 * 1:tdmout_b
		 * 2:tdmout_c
		 * 3:spdifout
		 * 4:spdifout_b
		 */
		eqdrc_module = <1>;
		/* max 0xf, each bit for one lane, usually one lane */
		lane_mask = <0x1>;
		/* max 0xff, each bit for one channel */
		channel_mask = <0x3>;
		status = "disabled";
	};
}; /* end of audiobus */

&earc {
	status = "okay";
};

/* Audio Related End */

&pwm_ef {
	status = "okay";
};

&dwc3 {
	status = "okay";
};

&usb2_phy_v2 {
	status = "okay";
	portnum = <2>;
};

&usb3_phy_v2 {
	status = "okay";
	portnum = <1>;
	otg = <1>;
};

&dwc2_a {
	status = "okay";
	/** 0: normal, 1: otg+dwc3 host only, 2: otg+dwc3 device only*/
	controller-type = <3>;
};
&ethmac {
	status = "okay";
	//pinctrl-names = "internal_eth_pins";
	//pinctrl-0 = <&internal_eth_pins>;
	mc_val = <0x4be04>;
	internal_phy=<1>;
	mac_wol = <1>;
};

&uart_A {
	status = "disabled";
};

&meson_cooldev {
	status = "okay";
};

&sd_emmc_b {
        status = "disabled";
};

&pcie {
        compatible = "amlogic, amlogic-pcie-v2";
        reset-gpio = <&gpio GPIOH_8 GPIO_ACTIVE_HIGH>;
        speed-mod = <1>;
        gpio-type = <1>; /* reset gpio type : OD */
        status = "okay";
};
